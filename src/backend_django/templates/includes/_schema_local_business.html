{% load static %}
{% load i18n %}
<!-- Schema.org JSON-LD for LocalBusiness -->
<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "LocalBusiness",
  "@id": "{{ site_settings.site_base_url }}#organization", {# Dynamic ID from SiteSettings #}
  "name": "{{ site_settings.company_name }}",
  "image": "{% static 'img/logo_lily.webp' %}", {# Keeping static for now, assuming no dynamic logo field #}
  "url": "{{ site_settings.site_base_url }}", {# Dynamic URL from SiteSettings #}
  "telephone": "{{ site_settings.phone }}",
  "email": "{{ site_settings.email }}",
  "address": {
    "@type": "PostalAddress",
    "streetAddress": "{{ site_settings.address_street }}",
    "addressLocality": "{{ site_settings.address_locality }}",
    "postalCode": "{{ site_settings.address_postal_code }}",
    "addressCountry": "DE" {# Keeping hardcoded, assuming constant #}
  },
  "geo": {
    "@type": "GeoCoordinates",
    "latitude": "{{ site_settings.latitude }}",
    "longitude": "{{ site_settings.longitude }}"
  },
  "openingHoursSpecification": [
    {
      "@type": "OpeningHoursSpecification",
      "dayOfWeek": [
        "Monday",
        "Tuesday",
        "Wednesday",
        "Thursday",
        "Friday"
      ],
      "opens": "{{ site_settings.work_start_weekdays }}",
      "closes": "{{ site_settings.work_end_weekdays }}"
    },
    {
      "@type": "OpeningHoursSpecification",
      "dayOfWeek": "Saturday",
      "opens": "{{ site_settings.work_start_saturday }}",
      "closes": "{{ site_settings.work_end_saturday }}"
    }
  ],
  "priceRange": "{{ site_settings.price_range }}",
  "sameAs": [
    "{{ site_settings.instagram_url }}",
    "https://www.facebook.com/lilybeautysalonkoethen/" {# Keeping hardcoded Facebook as no field in SiteSettings #}
  ],
  "potentialAction": {
    "@type": "ReserveAction",
    "target": {
      "@type": "EntryPoint",
      "urlTemplate": "{% url 'booking_wizard' %}", {# Using Django's url tag #}
      "inLanguage": "{{ request.LANGUAGE_CODE }}",
      "actionPlatform": [
        "https://schema.org/DesktopWebPlatform",
        "https://schema.org/MobileWebPlatform"
      ]
    },
    "name": "{% trans 'Записаться онлайн' %}"
  },
  "hasOfferCatalog": {
    "@type": "OfferCatalog",
    "name": "Beauty Services",
    "itemListElement": [
      {% if islands %}
        {% for island in islands %}
        {
          "@type": "OfferCatalog",
          "name": "{{ island.title }}",
          "itemListElement": [
            {% for service in island.services.all %}
            {
              "@type": "Offer",
              "itemOffered": {
                "@type": "Service",
                "name": "{{ service.title }}"
              }
            }{% if not forloop.last %},{% endif %}
            {% endfor %}
          ]
        }{% if not forloop.last %},{% endif %}
        {% endfor %}
      {% else %}
      {
        "@type": "OfferCatalog",
        "name": "Hair Services",
        "itemListElement": [
          {
            "@type": "Offer",
            "itemOffered": {
              "@type": "Service",
              "name": "Haircuts"
            }
          },
          {
            "@type": "Offer",
            "itemOffered": {
              "@type": "Service",
              "name": "Hair Coloring"
            }
          }
        ]
      },
      {
        "@type": "OfferCatalog",
        "name": "Nail Services",
        "itemListElement": [
          {
            "@type": "Offer",
            "itemOffered": {
              "@type": "Service",
              "name": "Manicure"
            }
          },
          {
            "@type": "Offer",
            "itemOffered": {
              "@type": "Service",
              "name": "Pedicure"
            }
          }
        ]
      }
      {% endif %}
    ]
  }
}
</script>
